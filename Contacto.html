<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contacto - ART-LINE</title>
    <link rel="stylesheet" href="styles-comun.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles-contacto.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Artifika&family=Press+Start+2P&display=swap" rel="stylesheet">
</head>
<body>
    <header class="banner">
        <div class="title-P">
            <h1 class="titulo-P">CONTACTO</h1>
        </div>
        <div id="nav">
            <nav aria-label="Navegaci√≥n principal" class="navegacion">
                <ul class="navegacion__list">
                    <li class="navegacion__item"><a class="navegacion__link" href="index.html">Inicio</a></li>
                    <li class="navegacion__item"><a class="navegacion__link" href="Guia.html">Gu√≠a</a></li>
                    <li class="navegacion__item"><a class="navegacion__link" href="Editor.html">Editor</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="main-container contacto-container">
        <section class="contacto-section">
            <div class="contacto-header">
                <h2 class="Sub-T">¬°Cont√°ctanos!</h2>
                <p class="Text">¬øTienes preguntas, sugerencias o quieres compartir tu arte? Escr√≠benos.</p>
            </div>

            <!-- Formulario con validaci√≥n -->
            <form id="formularioContacto" class="contacto-form"  action="https://formspree.io/f/xeeekedn"
  method="POST">
                
                <div class="form-group">
                    <label for="nombre" class="form-label">
                        Nombre completo <span class="required">*</span>
                    </label>
                    <input type="text" 
                        id="nombre" 
                        name="nombre" 
                        class="form-input"
                        required
                        minlength="3"
                        maxlength="50"
                        placeholder="Tu nombre"
                        aria-describedby="nombreHelp">
                    <small id="nombreHelp" class="form-help">
                        M√≠nimo 3 caracteres, m√°ximo 50.
                    </small>
                </div>

                <div class="form-group">
                    <label for="email" class="form-label">
                        Correo electr√≥nico <span class="required">*</span>
                    </label>
                    <input type="email" 
                        id="email" 
                        name="email" 
                        class="form-input"
                        required
                        placeholder="tu@email.com"
                        aria-describedby="emailHelp">
                    <small id="emailHelp" class="form-help">
                        Debe ser un email v√°lido (ej: usuario@dominio.com).
                    </small>
                </div>

                <div class="form-group">
                    <label for="asunto" class="form-label">
                        Asunto <span class="required">*</span>
                    </label>
                    <select id="asunto" 
                            name="asunto" 
                            class="form-select"
                            required>
                        <option value="" disabled selected>Selecciona un tema</option>
                        <option value="consulta">Consulta sobre pixel art</option>
                        <option value="sugerencia">Sugerencia para la web</option>
                        <option value="problema">Reportar un problema</option>
                        <option value="colaboracion">Propuesta de colaboraci√≥n</option>
                        <option value="otro">Otro</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="mensaje" class="form-label">
                        Mensaje <span class="required">*</span>
                    </label>
                    <textarea id="mensaje" 
                        name="mensaje" 
                        class="form-textarea"
                        required
                        minlength="10"
                        maxlength="500"
                        rows="5"
                        placeholder="Escribe tu mensaje aqu√≠..."
                        aria-describedby="mensajeHelp"></textarea>
                    <small id="mensajeHelp" class="form-help">
                        M√≠nimo 10 caracteres, m√°ximo 500. 
                        <span id="contador">0/500</span>
                    </small>
                </div>

                <div class="form-group form-checkbox">
                    <input type="checkbox" 
                        id="privacidad" 
                        name="privacidad"
                        class="form-checkbox-input"
                        required>
                    <label for="privacidad" class="form-checkbox-label">
                        Acepto la <a href="#" class="privacy-link">pol√≠tica de privacidad</a> 
                        y el tratamiento de mis datos para responder mi consulta.
                        <span class="required">*</span>
                    </label>
                </div>

                <div class="form-buttons">
                    <button type="submit" class="form-button submit-button">
                        Enviar mensaje
                    </button>
                    <button type="reset" class="form-button reset-button">
                        Limpiar formulario
                    </button>
                </div>

                <div class="form-note">
                    <p><strong>Nota:</strong> Los campos marcados con <span class="required">*</span> son obligatorios.</p>
                    <p>Al enviar, ver√°s los mensajes de error del navegador si hay datos incorrectos.</p>
                </div>
            </form>

            <!-- Informaci√≥n de contacto adicional -->
            <div class="contacto-info">
                <div class="info-card">
                    <h3 class="info-title">üìß Email de contacto</h3>
                    <p class="info-text">contacto@art-line.com</p>
                </div>
                <div class="info-card">
                    <h3 class="info-title">‚è∞ Tiempo de respuesta</h3>
                    <p class="info-text">24-48 horas h√°biles</p>
                </div>
                <div class="info-card">
                    <h3 class="info-title">üí¨ Redes sociales</h3>
                    <p class="info-text">Pr√≥ximamente en Instagram y Twitter</p>
                </div>
            </div>
        </section>
    </main>


    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3 class="footer-title">ART-LINE</h3>
                <p class="footer-text">Pixel art para todos</p>
                <div class="footer-social">
                    <a href="#" class="footer-icon" aria-label="Instagram">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="#" class="footer-icon" aria-label="Twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="https://youtube.com/javierAQF" rel="noopener" target="_blank" class="footer-icon" aria-label="YouTube">
                        <i class="fab fa-youtube"></i>
                    </a>
                    <a href="https://GitHub.com/J-AQF" rel="noopener" target="_blank" class="footer-icon" aria-label="GitHub">
                        <i class="fab fa-github"></i>
                    </a>
                </div>
            </div>
            
            <div class="footer-section">
                <h4 class="footer-subtitle">Enlaces</h4>
                <ul class="footer-links">
                    <li><a href="index.html">Inicio</a></li>
                    <li><a  href="Guia.html">Gu√≠a</a></li>
                    <li><a href="Editor.html">Editor</a></li>
                    <li><a class="active" href="contacto.html">Contacto</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4 class="footer-subtitle">Recursos</h4>
                <ul class="footer-links">
                    <li><a href="#">Tutoriales</a></li>
                    <li><a href="#">Paletas de color</a></li>
                    <li><a href="#">Herramientas</a></li>
                    <li><a href="#">Comunidad</a></li>
                </ul>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>¬© 2025 ART-LINE - Proyecto universitario</p>
        </div>
    </footer>

    <script>
    // Contador de caracteres para el textarea
    const mensajeTextarea = document.getElementById('mensaje');
    const contador = document.getElementById('contador');
    
    if (mensajeTextarea && contador) {
        mensajeTextarea.addEventListener('input', function() {
            const longitud = this.value.length;
            contador.textContent = `${longitud}/500`;
            
            // Cambiar color seg√∫n la longitud
            if (longitud > 450) {
                contador.style.color = 'var(--color-accent)';
            } else if (longitud < 10) {
                contador.style.color = '#ff6b6b';
            } else {
                contador.style.color = 'var(--color-secondary)';
            }
        });
        
        // Inicializar contador
        contador.textContent = `${mensajeTextarea.value.length}/500`;
    }
    
    // Manejo de validaci√≥n visual
    const formulario = document.getElementById('formularioContacto');
    if (formulario) {
        formulario.addEventListener('invalid', function(e) {
            e.preventDefault(); // Prevenir mensajes nativos
            e.target.classList.add('invalid');
            
            // Mostrar mensaje personalizado
            if (!e.target.nextElementSibling || !e.target.nextElementSibling.classList.contains('error-message')) {
                const errorMsg = document.createElement('div');
                errorMsg.className = 'error-message';
                errorMsg.textContent = 'Por favor, corrige este campo';
                errorMsg.style.color = '#ff6b6b';
                errorMsg.style.fontSize = '0.8em';
                errorMsg.style.marginTop = '5px';
                e.target.parentNode.appendChild(errorMsg);
            }
        }, true);
        
        formulario.addEventListener('input', function(e) {
            // Remover clase invalid cuando el usuario empiece a escribir
            if (e.target.classList.contains('invalid')) {
                e.target.classList.remove('invalid');
                // Remover mensaje de error
                const errorMsg = e.target.parentNode.querySelector('.error-message');
                if (errorMsg) errorMsg.remove();
            }
        });
    }
    
    // Env√≠o del formulario a Formspree
    const FORMSPREE_ENDPOINT = 'https://formspree.io/f/xeeekedn';
    
    formulario.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // Validaci√≥n manual
        if (!this.checkValidity()) {
            // Recorrer campos inv√°lidos
            const invalidFields = this.querySelectorAll(':invalid');
            invalidFields.forEach(field => {
                field.classList.add('invalid');
                // Mostrar mensaje de error
                if (!field.nextElementSibling || !field.nextElementSibling.classList.contains('error-message')) {
                    const errorMsg = document.createElement('div');
                    errorMsg.className = 'error-message';
                    
                    if (field.validity.valueMissing) {
                        errorMsg.textContent = 'Este campo es obligatorio';
                    } else if (field.validity.typeMismatch) {
                        errorMsg.textContent = 'Por favor, introduce un valor v√°lido';
                    } else if (field.validity.tooShort) {
                        errorMsg.textContent = `M√≠nimo ${field.minLength} caracteres`;
                    }
                    
                    errorMsg.style.color = '#ff6b6b';
                    errorMsg.style.fontSize = '0.8em';
                    errorMsg.style.marginTop = '5px';
                    field.parentNode.appendChild(errorMsg);
                }
            });
            
            // Enfocar el primer campo inv√°lido
            if (invalidFields.length > 0) {
                invalidFields[0].focus();
            }
            
            return;
        }
        
        // Mostrar estado de carga
        const submitBtn = this.querySelector('.submit-button');
        const originalText = submitBtn.textContent;
        const originalHTML = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Enviando...';
        submitBtn.disabled = true;
        
        console.log('Enviando datos a Formspree...');
        
        try {
            const formData = new FormData(this);
            console.log('Datos del formulario:', Object.fromEntries(formData));
            
            const response = await fetch(FORMSPREE_ENDPOINT, {
                method: 'POST',
                body: formData,
                headers: { 
                    'Accept': 'application/json',
                    'Content-Type': 'application/x-www-form-urlencoded'
                }
            });
            
            console.log('Respuesta HTTP:', response.status, response.statusText);
            
            let data;
            try {
                data = await response.json();
                console.log('Datos de respuesta:', data);
            } catch (parseError) {
                console.error('Error parseando JSON:', parseError);
                const text = await response.text();
                console.log('Respuesta en texto:', text);
                data = { error: 'Respuesta inesperada del servidor' };
            }
            
            if (response.ok) {
                // Mostrar mensaje de √©xito m√°s atractivo
                const successHTML = `
                    <div class="success-message" style="
                        background: #d4edda;
                        color: #155724;
                        padding: 15px;
                        border-radius: 8px;
                        margin: 20px 0;
                        border: 1px solid #c3e6cb;
                        text-align: center;
                    ">
                        <h3 style="margin-top: 0; color: #155724;">
                            <i class="fas fa-check-circle"></i> ¬°Mensaje enviado con √©xito!
                        </h3>
                        <p>Te responderemos en 24-48 horas h√°biles.</p>
                        <p><small>Revisa tu email para confirmar el env√≠o.</small></p>
                    </div>
                `;
                
                // Insertar mensaje antes del formulario
                formulario.insertAdjacentHTML('beforebegin', successHTML);
                
                // Resetear formulario
                this.reset();
                if (contador) contador.textContent = '0/500';
                
                // Desplazar al mensaje de √©xito
                const successMsg = document.querySelector('.success-message');
                if (successMsg) {
                    successMsg.scrollIntoView({ behavior: 'smooth' });
                }
                
            } else {
                // Manejar diferentes tipos de errores
                let errorMessage = 'Error al enviar. Intenta nuevamente.';
                
                if (data.error) {
                    if (data.error.includes('not activated') || data.error.includes('confirm')) {
                        errorMessage = '‚ùå Tu email en Formspree no est√° verificado. Revisa tu bandeja de entrada y haz clic en el enlace de confirmaci√≥n.';
                    } else if (data.error.includes('405')) {
                        errorMessage = '‚ùå Error 405: M√©todo no permitido. Intenta recargar la p√°gina.';
                    } else {
                        errorMessage = `‚ùå Error: ${data.error}`;
                    }
                } else if (response.status === 429) {
                    errorMessage = '‚ùå Demasiados intentos. Espera unos minutos.';
                }
                
                alert(errorMessage);
            }
        } catch (error) {
            console.error('Error de red:', error);
            alert('‚ùå Error de conexi√≥n. Verifica tu internet y vuelve a intentar.');
        } finally {
            // Restaurar bot√≥n
            submitBtn.innerHTML = originalHTML;
            submitBtn.textContent = originalText;
            submitBtn.disabled = false;
        }
    });
    
    // Prevenir que el bot√≥n de reset elimine los mensajes de error
    const resetBtn = formulario.querySelector('.reset-button');
    if (resetBtn) {
        resetBtn.addEventListener('click', function() {
            // Limpiar mensajes de error
            const errorMessages = formulario.querySelectorAll('.error-message');
            errorMessages.forEach(msg => msg.remove());
            
            // Limpiar clases invalid
            const invalidFields = formulario.querySelectorAll('.invalid');
            invalidFields.forEach(field => field.classList.remove('invalid'));
            
            // Resetear contador
            if (contador) contador.textContent = '0/500';
        });
    }
</script>
</body>
</html>